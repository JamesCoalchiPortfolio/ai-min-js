(function(w,k,u){w[k]=w[k]||null;let e="AI Error: ",c=" Check console.";async function _(p,a){let m,s;if(!a)return console.error(m=e+"Key missing",s=" Set w."+k+" or use ask()."),alert(m+s),e+"Key not set";if(!p||!p.trim())return console.error(m=e+"No prompt"),alert(m),m;try{let r=await fetch(u+a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:p}]}]})});if(!r.ok){let d=`HTTP ${r.status}`;try{d+=` - ${(await r.text()).substring(0,80)}`}catch(z){}return console.error(m=e+d),alert(m),m}let j=await r.json(),x=j?.candidates?.[0]?.content?.parts?.[0]?.text;if(x)return x;return console.error(m=e+"Bad response",j),alert(m+c),m}catch(f){return console.error(m=e+"Request fail: "+f.message,f),alert(m+c),m}}w.ask=async p=>{let m;if(!w[k]){let i=prompt("API Key (session):");if(i)w[k]=i;else return console.error(m=e+"Key required"),alert(m),void 0}return _(p,w[k])}})(window,"MY_GEMINI_API_KEY","https://jprox.ddominicyspon.workers.dev/v1beta/models/gemini-2.0-flash:generateContent?key=");
